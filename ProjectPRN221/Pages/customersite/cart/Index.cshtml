@page
@model ProjectPRN221.Pages.customersite.cart.IndexModel
@{
    ViewData["Title"] = "Cart";
    Layout = "CustomerLayout";
}
    
    @*HEADER*@
<partial name="/Pages/_HeaderCustomersite.cshtml" model="new ProjectPRN221.Pages._HeaderCustomerSiteModel()" />

    @*BANNER*@
     <section class="site-banner padding-small bg-light-grey">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="breadcrumbs">
                            <span class="item">
                                <a href="HomeControlle">Home /</a>
                            </span>
                            <span class="item">
                                <a href="ShopController">Shop /</a>
                            </span>
                            <span class="item">Cart</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    @*CART*@
       <section class="shopify-cart padding-large">
@*            <div>
                <h4 style="text-align: center">${ms}</h4>
            </div>*@

            <form  method="post">  

            <div class="container">

                <div class="cart-table">

                    <div class="cart-header border-bottom ">
                        <div class="row d-flex">
                            <h3 class="cart-title col-lg-4">Product</h3>
                            <h3 class="cart-title col-lg-3">Quantity</h3>
                            <h3 class="cart-title col-lg-4">Subtotal</h3>
                        </div>
                    </div>
                        
                        <div class="cart-item border-bottom padding-small">
                        <input type="hidden" name="service" value="Update">
                        @for (int i = 0; i < Model.Carts.Count; i++)
                        {   
                               var item = Model.Carts[i];
                               <input type="hidden" name="id[@i]" value="@item.id">
                                <div class="row"> 
                                    <div class="col-lg-4 col-md-3">
                                        <div class="row cart-info d-flex flex-wrap">
                                            <div class="col-lg-5">
                                                <div class="card-image">
                                                    <img src="@item.image" alt="cloth" class="img-fluid">
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="card-detail">
                                                    <h3 class="card-title">
                                                        <a href="/customersite/productdetail/Index?id=@item.id">@item.name</a>
                                                    </h3>
                                                    <div class="card-price">
                                                        <span class="money text-primary number">@item.price</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-6 col-md-7">
                                        <div class="row d-flex">
                                            <div class="col-lg-6">
                                                <div class="qty-number d-flex align-items-center justify-content-start">
                                                    <button class="decrement-button" data-index="@i">-</button>
                                                    <input type="text" name="quantity[@i]"class="spin-number-output" value="@item.quantity" min="1" max="100">
                                                    <button class="increment-button" data-index="@i">+</button>
                                                </div>
                                            </div>
                                            <div class="col-lg-4">
                                                <div class="total-price" style="margin-top: 25px">
                                                    <span class="money text-primary number">@item.subtotal</span>
                                                </div>
                                            </div>   
                                        </div>             
                                    </div>
                                    <div class="col-lg-1 col-md-2">
                                        <div class="cart-remove" style="margin-top: 30px">
                                            <a href="/customersite/cart/Index?service=Delete&proid=@item.id"><i class="icon icon-close"></i></a>
                                        </div>
                                    </div>
                                </div>
                        }
                        </div>
                </div>

                <div class="cart-totals">
                    <h2 class="section-title">Cart Totals</h2>
                    <div class="total-price">
                        <table cellspacing="0" class="table">
                            <tbody>
                                <tr class="subtotal">
                                    <th>Subtotal</th>
                                    <td data-title="Subtotal">
                                        <span class="price-amount amount text-primary">
                                            <bdi>
                                                <span class="price-currency-symbol number">@Model.totalprice</span>
                                            </bdi>
                                        </span>
                                    </td>
                                </tr>
                                <tr class="order-total">
                                    <th>Total</th>
                                    <td data-title="Total">
                                        <span class="price-amount amount text-primary">
                                            <bdi>
                                                <span class="price-currency-symbol number">@Model.totalprice</span></bdi>
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="button-wrap">
                        <button type="submit" name="submit" class="btn btn-dark btn-medium">Update Cart</button>
                        <a href="/customersite/shop" class="btn btn-dark btn-medium">Continue Shopping</a>
                        <a href="/customersite/checkout" class="btn btn-dark btn-medium">Proceed to checkout</a>
                    </div>
                </div>
            </div>
           </form>
        </section>



        @*SALE BANNER*@
        <section id="shipping-information">
            <hr>
            <div class="container">
                <div class="row d-flex flex-wrap align-items-center justify-content-between">
                    <div class="col-md-3 col-sm-6">
                        <div class="icon-box">
                            <i class="icon icon-truck"></i>
                            <h4 class="block-title">
                                <strong>Free shipping</strong> Over $200
                            </h4>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="icon-box">
                            <i class="icon icon-return"></i>
                            <h4 class="block-title">
                                <strong>Money back</strong> Return within 7 days
                            </h4>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="icon-box">
                            <i class="icon icon-tags1"></i>
                            <h4 class="block-title">
                                <strong>Buy 4 get 5th</strong> 50% off
                            </h4>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="icon-box">
                            <i class="icon icon-help_outline"></i>
                            <h4 class="block-title">
                                <strong>Any questions?</strong> experts are ready
                            </h4>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
        </section>


     @*FOOTER*@
<partial name="/Pages/_FooterCustomerSite.cshtml" model="new ProjectPRN221.Pages._FooterCustomerSiteModel()" />

        <script>
            const decrementButtons = document.getElementsByClassName('decrement-button');
            const incrementButtons = document.getElementsByClassName('increment-button');

            for (let i = 0; i < decrementButtons.length; i++) {
                decrementButtons[i].addEventListener('click', function (event) {
                    event.preventDefault();
                    const parent = this.closest('.row');
                    const inputField = parent.querySelector('.spin-number-output');
                    decreaseValue(inputField);
                });
            }

            for (let i = 0; i < incrementButtons.length; i++) {
                incrementButtons[i].addEventListener('click', function (event) {
                    event.preventDefault();
                    const parent = this.closest('.row');
                    const inputField = parent.querySelector('.spin-number-output');
                    increaseValue(inputField);
                });
            }


            const inputFields = document.getElementsByClassName('spin-number-output');

            for (let i = 0; i < inputFields.length; i++) {

                const inputField = inputFields[i];

                inputField.addEventListener('input', function (event) {
                    let value = this.value;
                    value = value.replace(/[^\d]/g, ''); 

                    if (value === '' || value < 1 || value > 100) {
                        this.value = 1;
                    } else {
                        this.value = value;
                    }
                });
            }


            function increaseValue(inputField) {
                let value = parseInt(inputField.value);
                if (value < 100) {
                    value++;
                    inputField.value = value;
                }
            }

            function decreaseValue(inputField) {
                let value = parseInt(inputField.value);
                if (value > 1) {
                    value--;
                    inputField.value = value;
                }
            }

        </script>

        <div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button type="button" id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div>
